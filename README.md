# QNA 插件

用于自动回答群聊问题的AstrBot插件

## 功能

- 自动识别群聊中的问题并给出回答
- 支持配置自定义问题关键词和群聊列表
- 通过 LLM 提供智能化的问答功能

## 配置项

- **question_keyword_list**: 用于指定自动识别的提问关键字，多个关键词用分号 `;` 分隔。
- **qna_group_list**: 用于指定启用自动问答的群组 ID，多个群组 ID 用分号 `;` 分隔。
- **llm_answer_probability**: 控制 LLM 回答的概率，值在 `0.0` 到 `1.0` 之间，表示触发 LLM 回答的概率，默认 `0.1`。

## 插件使用说明

### 自动回答逻辑

1. 插件会自动检测群聊中的消息是否包含指定的关键词。
2. 如果消息符合条件，插件将判断是否调用 LLM 提供答案。
3. 只有在消息字数小于 50 且符合概率要求时，插件才会调用 LLM 回答。
4. LLM 回答内容会根据预设的规则回答。

### 常用指令

- `/qna enable` / `/qna disable`：开启/关闭自动解答。
- `/qna id`：查看当前群号（私聊无效）。
- `/qna group list`：查看已启用自动解答的群号白名单。
- `/qna group add <群号>`：将群加入白名单。
- `/qna group del <群号>`：将群从白名单移除。

### 默认策略说明

- 群聊且未被 @ 时才会自动触发；机器人自己的消息不会触发。
- 仅白名单群组+命中关键词才会继续判断（关键词配置会自动忽略多余分号/空项）。
- 字数超过 50 直接忽略；调用 LLM 的默认概率为 0.1，可通过配置调整。

## 更新日志

### v1.1.10

- 修复自发消息误判、空关键词导致正则误触。
- 解析会话历史失败时降级为无上下文，避免异常中断。
- 统一 LLM 调用概率默认值为 0.1，并补充指令/默认策略说明。

### v0.0.1

- 初始版本发布，支持基本的自动问答功能。

## 开源协议

本插件基于 MIT License 开源。
